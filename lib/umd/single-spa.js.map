{"version":3,"file":"single-spa.js","sources":["../../src/application/app.helpers.js","../../src/start.js","../../src/navigations/reroute.js","../../src/application/app.js"],"sourcesContent":["// 描述应用的整个状态\nexport const NOT_LOADED = 'NOT_LOADED';// 应用初始状态\nexport const LOADING_SOURCE_CODE = 'LOADING_SOURCE_CODE'; // 加载资源\nexport const NOT_BOOTSTRAPPED = 'NOT_BOOTSTRAPPED'; // 还没有调用bootstrap方法\nexport const BOOTSTRAPPING = 'BOOTSTRAPPING'; // 启动中\nexport const NOT_MOUNTED = 'NOT_MOUNTED';// 没有调用mount方法\nexport const MOUNTING = 'MOUNTING'; // 正在挂载中\nexport const MOUNTED = 'MOUNTED'; // 挂载完毕\nexport const UPDATINMG = 'UPDATINMG'; // 更新中\nexport const UNMOUNTING = 'UNMOUNTING' // 解除挂载\nexport const UNLOADING = 'UNLOADING'// 完全卸载中\nexport const LOAD_ERR = 'LOAD_ERR';\nexport const SKIP_BECAUSE_BROKEN = 'SKIP_BECAUSE_BROKEN';\n\n// 当前应用是否被激活\nexport function isActive(app) {\n    return app.status === MOUNTED\n}\n// 当前这个应用是否要被激活\nexport function shouldBeActive(app) { //如果返回true 那么应用应该就开始初始化等一系列操作\n    return app.activeWhen(window.location)\n}","import { reroute } from \"./navigations/reroute\";\n\nexport let started = false\nexport function start() {\n    // 挂载应用\n    started = true\n    reroute() // 除了去加载应用，还需要去挂载应用\n}","import { started } from '../start.js'\nimport { getAppChanges } from \"../application/app.js\";\n\n\n// 核心应用处理方法\nexport function reroute() {\n    //  需要获取要加载的应用\n    //  需要获取要被挂载的应用\n    //  哪些应用需要被卸载\n    const { appsToLoad, appsToMount, appsToUnmount } = getAppChanges()\n    console.log(appsToLoad, appsToMount, appsToUnmount)\n    // start方法调用时是同步的，但是加载流程是异步饿\n    if (started) {\n        // app装载\n        return performAppChanges();\n    } else {\n        // 注册应用时 需要预先加载\n        return loadApps()\n    }\n    async function loadApps() { // 预加载应用\n    }\n    async function performAppChanges() { // 根据路径来装载应用\n    }\n}\n\n\n// 这个流程是用于初始化操作的，我们还需要 当路径切换时重新加载应用\n// 重写路由相关的方法","import { NOT_LOADED, SKIP_BECAUSE_BROKEN, shouldBeActive, LOADING_SOURCE_CODE, NOT_BOOTSTRAPPED, NOT_MOUNTED, BOOTSTRAPPING, MOUNTED } from \"./app.helpers\";\n\nimport { reroute } from '../navigations/reroute'\n\n/**\n * 微前端注册\n * @param {*} appName 应用名称\n * @param {*} loadApp 加载的应用\n * @param {*} activeWhen 当激活时会调用\n * @param {*} customProps 自定义参数\n */\n\n// 用来存放所有的应用\nconst apps = []\n\n// 维护应用所有状态 状态机\nexport function registerApplication(appName, loadApp, activeWhen, customProps) {\n    apps.push({ // 注册应用\n        name: appName,\n        loadApp,\n        activeWhen,\n        customProps,\n        status: NOT_LOADED\n    })\n    reroute() // 加载应用\n    // vue 一系列的生命周期\n}\n\nexport function getAppChanges() {\n    const appsToUnmount = []; // 要卸载的app\n    const appsToLoad = []; // 要加载的app\n    const appsToMount = []; // 需要挂载的\n    apps.forEach(app => {\n        // 需不需要被加载\n        const appSholdBeActive = shouldBeActive(app);\n        switch (app.status) { // toLoad\n            case NOT_LOADED:\n            case LOADING_SOURCE_CODE:\n                if (appSholdBeActive) {// 做判断了\n                    appsToLoad.push(app);\n                }\n                break\n            case NOT_BOOTSTRAPPED: // toMount\n            case BOOTSTRAPPING:\n            case NOT_MOUNTED:\n                if (appSholdBeActive) {\n                    appsToMount.push(app);\n                }\n                break;\n            case MOUNTED:  // unmount\n                if (!appSholdBeActive) {\n                    appsToUnmount.push(app)\n                }\n        }\n    });\n    return { appsToUnmount, appsToLoad, appsToMount }\n}"],"names":[],"mappings":";;;;;;IAAA;IACO,MAAM,UAAU,GAAG,YAAY,CAAC;IAChC,MAAM,mBAAmB,GAAG,qBAAqB,CAAC;IAClD,MAAM,gBAAgB,GAAG,kBAAkB,CAAC;IAC5C,MAAM,aAAa,GAAG,eAAe,CAAC;IACtC,MAAM,WAAW,GAAG,aAAa,CAAC;IAElC,MAAM,OAAO,GAAG,SAAS,CAAC;IAWjC;IACO,SAAS,cAAc,CAAC,GAAG,EAAE;IACpC,IAAI,OAAO,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC;IAC1C;;ICnBO,IAAI,OAAO,GAAG,MAAK;IACnB,SAAS,KAAK,GAAG;IACxB;IACA,IAAI,OAAO,GAAG,KAAI;IAClB,IAAI,OAAO,GAAE;IACb;;ICHA;IACO,SAAS,OAAO,GAAG;IAC1B;IACA;IACA;IACA,IAAI,MAAM,EAAE,UAAU,EAAE,WAAW,EAAE,aAAa,EAAE,GAAG,aAAa,GAAE;IACtE,IAAI,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,WAAW,EAAE,aAAa,EAAC;IACvD;IACA,IAAI,IAAI,OAAO,EAAE;IACjB;IACA,QAAQ,OAAO,iBAAiB,EAAE,CAAC;IACnC,KAAK,MAAM;IACX;IACA,QAAQ,OAAO,QAAQ,EAAE;IACzB,KAAK;IACL,IAAI,eAAe,QAAQ,GAAG;IAC9B,KAAK;IACL,IAAI,eAAe,iBAAiB,GAAG;IACvC,KAAK;IACL,CAAC;AACD;AACA;IACA;IACA;;ICvBA;IACA;IACA;IACA;IACA;IACA;IACA;AACA;IACA;IACA,MAAM,IAAI,GAAG,GAAE;AACf;IACA;IACO,SAAS,mBAAmB,CAAC,OAAO,EAAE,OAAO,EAAE,UAAU,EAAE,WAAW,EAAE;IAC/E,IAAI,IAAI,CAAC,IAAI,CAAC;IACd,QAAQ,IAAI,EAAE,OAAO;IACrB,QAAQ,OAAO;IACf,QAAQ,UAAU;IAClB,QAAQ,WAAW;IACnB,QAAQ,MAAM,EAAE,UAAU;IAC1B,KAAK,EAAC;IACN,IAAI,OAAO,GAAE;IACb;IACA,CAAC;AACD;IACO,SAAS,aAAa,GAAG;IAChC,IAAI,MAAM,aAAa,GAAG,EAAE,CAAC;IAC7B,IAAI,MAAM,UAAU,GAAG,EAAE,CAAC;IAC1B,IAAI,MAAM,WAAW,GAAG,EAAE,CAAC;IAC3B,IAAI,IAAI,CAAC,OAAO,CAAC,GAAG,IAAI;IACxB;IACA,QAAQ,MAAM,gBAAgB,GAAG,cAAc,CAAC,GAAG,CAAC,CAAC;IACrD,QAAQ,QAAQ,GAAG,CAAC,MAAM;IAC1B,YAAY,KAAK,UAAU,CAAC;IAC5B,YAAY,KAAK,mBAAmB;IACpC,gBAAgB,IAAI,gBAAgB,EAAE;IACtC,oBAAoB,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACzC,iBAAiB;IACjB,gBAAgB,KAAK;IACrB,YAAY,KAAK,gBAAgB,CAAC;IAClC,YAAY,KAAK,aAAa,CAAC;IAC/B,YAAY,KAAK,WAAW;IAC5B,gBAAgB,IAAI,gBAAgB,EAAE;IACtC,oBAAoB,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC1C,iBAAiB;IACjB,gBAAgB,MAAM;IACtB,YAAY,KAAK,OAAO;IACxB,gBAAgB,IAAI,CAAC,gBAAgB,EAAE;IACvC,oBAAoB,aAAa,CAAC,IAAI,CAAC,GAAG,EAAC;IAC3C,iBAAiB;IACjB,SAAS;IACT,KAAK,CAAC,CAAC;IACP,IAAI,OAAO,EAAE,aAAa,EAAE,UAAU,EAAE,WAAW,EAAE;IACrD;;;;;;;;;;;;;"}